import React,{useState,useEffect} from 'react';import { loadStripe } from '@stripe/stripe-js';import { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';import axios from 'axios';import { STRIPE_PUBLISHABLE_KEY, API_BASE } from './config';const stripePromise = loadStripe(STRIPE_PUBLISHABLE_KEY);function CheckoutForm({booking}){const stripe=useStripe();const elements=useElements();const [clientSecret,setClientSecret]=useState(null);useEffect(()=>{async function init(){const r=await axios.post(API_BASE+'/create-payment-intent',{booking_id:booking.id}); if(r.data.clientSecret) setClientSecret(r.data.clientSecret);} init();},[booking]);const handleSubmit=async e=>{e.preventDefault(); if(!stripe||!elements) return; const result = await stripe.confirmCardPayment(clientSecret,{payment_method:{card:elements.getElement(CardElement)}}); if(result.error){alert('Payment failed: '+result.error.message);return;} if(result.paymentIntent&&result.paymentIntent.status==='succeeded'){await axios.post(API_BASE+'/pay',{booking_id:booking.id}); alert('Payment success'); window.location.reload();}};return (<div style={{padding:12}}>{clientSecret? (<form onSubmit={handleSubmit}><div style={{padding:10,background:'#fff',color:'#000'}}><CardElement /></div><div style={{marginTop:8}}><button className='btn' type='submit'>Pay Now</button></div></form>):<div>Initializing payment...</div>}</div>);}export default function Payment({booking}){return (<Elements stripe={stripePromise}><CheckoutForm booking={booking} /></Elements>);}