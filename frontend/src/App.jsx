import React,{useEffect,useState} from 'react';import axios from 'axios';import SeatMap from './SeatMap';import ChatBox from './ChatBox';import Payment from './Payment';import { API_BASE } from './config';export default function App(){const [movies,setMovies]=useState([]);const [snacks,setSnacks]=useState([]);const [view,setView]=useState('home');const [selectedMovie,setSelectedMovie]=useState(null);const [selectedSeats,setSelectedSeats]=useState([]);const [cart,setCart]=useState({});const [booking,setBooking]=useState(null);useEffect(()=>{axios.get(API_BASE+'/movies').then(r=>setMovies(r.data));axios.get(API_BASE+'/snacks').then(r=>setSnacks(r.data));},[]);function toggleSeat(label){ if(selectedSeats.includes(label)) setSelectedSeats(s=>s.filter(x=>x!==label)); else setSelectedSeats(s=>[...s,label]); }function changeSnack(id,delta){ setCart(prev=>{const c={...prev}; c[id]=Math.max(0,(c[id]||0)+delta); if(c[id]===0) delete c[id]; return c; }); }async function confirmBooking(movie){ if(selectedSeats.length===0) return alert('Select seats'); const snackIds=Object.keys(cart).map(x=>parseInt(x)); const name=prompt('Your name:')||'Guest'; const r=await axios.post(API_BASE+'/book',{movie_id:movie.id,seats:selectedSeats,snack_ids:snackIds,user_name:name}); if(r.data.booking){ setBooking(r.data.booking); setView('payment'); } }return (<div className='container'><header className='topbar'><h1>Movie Tickets</h1><div><button className='btn' onClick={()=>setView('home')}>Home</button></div></header>{view==='home' && (<div className='movies'>{movies.map(m=>(<div key={m.id} className='card'><img src={m.poster} className='poster' alt={m.title} /><h3>{m.title}</h3><p>{m.description}</p><div className='showtimes'><button className='btn' onClick={()=>{setSelectedMovie(m); setView('select')}}>Select Seats</button></div></div>))}</div>)}{view==='select' && selectedMovie && (<div style={{marginTop:20,display:'flex',gap:16}}><div style={{flex:1}}><h2>Select Seats - {selectedMovie.title}</h2><SeatMap seats={[{id:1,label:'A1',status:'available'},{id:2,label:'A2',status:'available'},{id:3,label:'A3',status:'available'},{id:4,label:'A4',status:'available'},{id:5,label:'A5',status:'sold'},{id:6,label:'A6',status:'available'}]} onToggle={(s)=>toggleSeat(s.label)} /></div><div style={{width:320}}><h3>Snacks</h3><div className='snack-list'>{snacks.map(it=>(<div key={it.id} className='snack-item'><div>{it.name} - â‚¹{it.price}</div><div><button className='btn' onClick={()=>changeSnack(it.id,-1)}>-</button><span style={{margin:'0 8px'}}>{cart[it.id]||0}</span><button className='btn' onClick={()=>changeSnack(it.id,1)}>+</button></div></div>))}</div><div style={{marginTop:12}}><button className='btn' onClick={()=>confirmBooking(selectedMovie)}>Confirm Booking</button></div></div></div>)}{view==='payment' && booking && (<div style={{marginTop:20}}><h2>Payment for Booking #{booking.id}</h2><Payment booking={booking} /></div>)}<ChatBox /></div>); }