{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\andav\\\\Downloads\\\\movie-ticket-final\\\\frontend\\\\src\\\\Payment.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport axios from 'axios';\nimport { STRIPE_PUBLISHABLE_KEY, API_BASE } from './config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(STRIPE_PUBLISHABLE_KEY);\nfunction CheckoutForm({\n  booking\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const [clientSecret, setClientSecret] = useState(null);\n  useEffect(() => {\n    async function init() {\n      const r = await axios.post(API_BASE + '/create-payment-intent', {\n        booking_id: booking.id\n      });\n      if (r.data.clientSecret) setClientSecret(r.data.clientSecret);\n    }\n    init();\n  }, [booking]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    const result = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement)\n      }\n    });\n    if (result.error) {\n      alert('Payment failed: ' + result.error.message);\n      return;\n    }\n    if (result.paymentIntent && result.paymentIntent.status === 'succeeded') {\n      await axios.post(API_BASE + '/pay', {\n        booking_id: booking.id\n      });\n      alert('Payment success');\n      window.location.reload();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 12\n    },\n    children: clientSecret ? /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: 10,\n          background: '#fff',\n          color: '#000'\n        },\n        children: /*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1,\n          columnNumber: 1260\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1,\n        columnNumber: 1203\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 8\n        },\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          type: \"submit\",\n          children: \"Pay Now\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1,\n          columnNumber: 1308\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1,\n        columnNumber: 1281\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1,\n      columnNumber: 1173\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Initializing payment...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1,\n      columnNumber: 1377\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1,\n    columnNumber: 1131\n  }, this);\n}\n_s(CheckoutForm, \"CzQSBFxZpmGNyJhhEPI7VJQ6WZ8=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nexport default function Payment({\n  booking\n}) {\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n      booking: booking\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1,\n      columnNumber: 1505\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1,\n    columnNumber: 1472\n  }, this);\n}\n_c2 = Payment;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Payment\");","map":{"version":3,"names":["React","useState","useEffect","loadStripe","Elements","CardElement","useStripe","useElements","axios","STRIPE_PUBLISHABLE_KEY","API_BASE","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","booking","_s","stripe","elements","clientSecret","setClientSecret","init","r","post","booking_id","id","data","handleSubmit","e","preventDefault","result","confirmCardPayment","payment_method","card","getElement","error","alert","message","paymentIntent","status","window","location","reload","style","padding","children","onSubmit","background","color","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","className","type","_c","Payment","_c2","$RefreshReg$"],"sources":["C:/Users/andav/Downloads/movie-ticket-final/frontend/src/Payment.jsx"],"sourcesContent":["import React,{useState,useEffect} from 'react';import { loadStripe } from '@stripe/stripe-js';import { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';import axios from 'axios';import { STRIPE_PUBLISHABLE_KEY, API_BASE } from './config';const stripePromise = loadStripe(STRIPE_PUBLISHABLE_KEY);function CheckoutForm({booking}){const stripe=useStripe();const elements=useElements();const [clientSecret,setClientSecret]=useState(null);useEffect(()=>{async function init(){const r=await axios.post(API_BASE+'/create-payment-intent',{booking_id:booking.id}); if(r.data.clientSecret) setClientSecret(r.data.clientSecret);} init();},[booking]);const handleSubmit=async e=>{e.preventDefault(); if(!stripe||!elements) return; const result = await stripe.confirmCardPayment(clientSecret,{payment_method:{card:elements.getElement(CardElement)}}); if(result.error){alert('Payment failed: '+result.error.message);return;} if(result.paymentIntent&&result.paymentIntent.status==='succeeded'){await axios.post(API_BASE+'/pay',{booking_id:booking.id}); alert('Payment success'); window.location.reload();}};return (<div style={{padding:12}}>{clientSecret? (<form onSubmit={handleSubmit}><div style={{padding:10,background:'#fff',color:'#000'}}><CardElement /></div><div style={{marginTop:8}}><button className='btn' type='submit'>Pay Now</button></div></form>):<div>Initializing payment...</div>}</div>);}export default function Payment({booking}){return (<Elements stripe={stripePromise}><CheckoutForm booking={booking} /></Elements>);}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}